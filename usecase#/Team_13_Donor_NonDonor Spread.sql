select CONTACT_DIST.* , 
case when ACCT.NPE01__LIFETIMEDONATIONHISTORY_AMOUNT__C >0 then 'DONOR'
ELSE 'NON_DONOR' END AS "DONOR/NON_DONOR"
from 
( select * from 

(SELECT 
'2017CONFREGISTRANT' AS EVENT,"Full Name" as Full_Name, 
"Email Address" as Email, 
"Work City" AS CITY, 
"Work Country" AS COUNTRY
FROM "PROD_CTF_RAW"."SRC_SPREADSHEET"."2017NFCONFERENCEREGISTRATION"
union
SELECT 
'2018CONFREGISTRANT' AS EVENT,CONCAT("First Name","Last Name") as Full_Name,
"Email",
"City", 
"Country"
FROM "PROD_CTF_RAW"."SRC_SPREADSHEET"."2018NFCONFERENCEREGISTRATION"
union
SELECT 
'2019CONFREGISTRANT' AS EVENT,"Full Name" as Full_Name, 
"Email Address"  AS Email, 
"Work City" AS CITY, 
"Work Country" AS COUNTRY
FROM "PROD_CTF_RAW"."SRC_SPREADSHEET"."2019NFCONFERENCEREGISTRATION"
union 
SELECT 
'2020CONFREGISTRANT' AS EVENT,"Full Name" as Full_Name, 
"Email Address" AS EMAIL , 
"Work City" AS CITY, 
"Work Country" AS COUNTRY
FROM "PROD_CTF_RAW"."SRC_SPREADSHEET"."2020NFCONFERENCEREGISTRATION"
union 

SELECT 
'2021CONFREGISTRANT' AS EVENT,"Full Name" as Full_Name, 
"Email Address" AS EMAIL, 
"Work City" AS CITY, 
"Work Country" AS COUNTRY
FROM "PROD_CTF_RAW"."SRC_SPREADSHEET"."2021NFCONFERENCEREGISTRATION"
union 
SELECT 
'2021HACKFORRARE' AS EVENT,"First and Last Name" as Full_Name, 
"Email Address" AS EMAIL, 
'Default' AS CITY, 
'Country' AS COUNTRY
FROM  "PROD_CTF_RAW"."SRC_SPREADSHEET"."2021NFHACKFORRARE"

union 
SELECT 
'CLINICS' AS EVENT,CONCAT("First Name","Last Name") as Full_Name, 
"Email" AS EMAIL, 
'Default' AS CITY, 
'Country' AS COUNTRY
FROM  "PROD_CTF_RAW"."SRC_SPREADSHEET"."CLINICS" 

) 
 
qualify row_number() over (partition by EMAIL order by Event) = 1 )
 CONTACT_DIST

LEFT JOIN "PROD_CTF_RAW"."SRC_SF"."CTF_SF_ACCOUNT" ACCT
ON CONTACT_DIST.EMAIL = ACCT.PRIMARY_CONTACT_EMAIL__C